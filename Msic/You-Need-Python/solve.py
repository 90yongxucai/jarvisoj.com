#!/usr/bin/env python2
import hashlib

key = '_____*((__//__+___+______-____%____)**((___%(___-_))+________+(___%___+_____+_______%__+______-(______//(_____%___)))))+__*(((________/__)+___%__+_______-(________//____))**(_*(_____+_____)+_______+_________%___))+________*(((_________//__+________%__)+(_______-_))**((___+_______)+_________-(______//__)))+_______*((___+_________-(______//___-_______%__%_))**(_____+_____+_____))+__*(__+_________-(___//___-_________%_____%__))**(_________-____+_______)+(___+_______)**(________%___%__+_____+______)+(_____-__)*((____//____-_____%____%_)+_________)**(_____-(_______//_______+_________%___)+______)+(_____+(_________%_______)*__+_)**_________+_______*(((_________%_______)*__+_______-(________//________))**_______)+(________/__)*(((____-_+_______)*(______+____))**___)+___*((__+_________-_)**_____)+___*(((___+_______-______/___+__-_________%_____%__)*(___-_+________/__+_________%_____))**__)+(_//_)*(((________%___%__+_____+_____)%______)+_______-_)**___+_____*((______/(_____%___))+_______)*((_________%_______)*__+_____+_)+___//___+_________+_________/___'
c = '-185-147-211-221-164-217-188-169-205-174-211-225-191-234-148-199-198-253-175-157-222-135-240-229-201-154-178-187-244-183-212-222-164'

def sha1(string):
    return hashlib.sha1(string).hexdigest()

def calc(s):
    return sum([ int(s[i], 16) for i in range(len(s)) ])

def decrypt(ciphertext, key):
    keySHA1 = sha1(key)
    intSHA1 = calc(keySHA1)
    ciphertext = (ciphertext[1:] if ciphertext[0] == '-' else ciphertext).split('-')
    ciphertext = [ -int(ciphertext[i]) for i in range(len(ciphertext)) ]
    m = ''
    for i in range(len(ciphertext)):
        m += chr(ciphertext[i] + intSHA1 - int(keySHA1[i % 40], 16))
        intSHA1 = calc(sha1(m)[:20] + sha1(str(intSHA1))[:20])
    return m

key = key.replace('_________', '9').replace('________', '8').replace('_______', '7').replace('______', '6').replace('_____', '5').replace('____', '4').replace('___', '3').replace('__', '2').replace('_', '1')
key = eval(key)
key = ('%x' % key).decode('hex')
print(decrypt(c, key))

